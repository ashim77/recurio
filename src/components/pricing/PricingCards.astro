---
const { pricingTiers, colorClasses, iconSvg } = Astro.props;
---

<div class="bg-white py-20" id="pricing-cards">
	<div class="max-w-7xl mx-auto px-6 lg:px-8">
		<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
			{pricingTiers.map((tier, index) => {
				const colors = colorClasses[tier.accentColor];
				const planId = tier.name.toLowerCase();

				return (
					<div
						key={index}
						class={`relative bg-white rounded-2xl border-2 overflow-visible transition-all duration-300 hover:shadow-2xl ${
							tier.popular ? `${colors.ring} border-transparent shadow-xl scale-105` : 'border-slate-200 hover:border-slate-300'
						}`}
					>
						{tier.badge && (
							<div class="absolute -top-4 left-0 right-0 flex justify-center z-10">
								<div class={`${colors.badge} px-5 py-2 rounded-full text-xs font-bold text-white shadow-lg flex items-center gap-1.5`}>
									{tier.badge === 'MOST POPULAR' && (
										<span class="inline-flex" set:html={iconSvg('star', 'w-3.5 h-3.5')}></span>
									)}
									{tier.badge === 'BEST VALUE' && (
										<span class="inline-flex" set:html={iconSvg('award', 'w-3.5 h-3.5')}></span>
									)}
									{tier.badge}
								</div>
							</div>
						)}

						<div class="p-8 pt-12">
							<div class="text-center mb-8 pb-8 border-b border-slate-200">
								<h3 class="text-sm font-bold text-slate-500 tracking-wider mb-3">{tier.name}</h3>
								<div class="mb-2">
									<span class="text-5xl font-bold text-slate-900">{tier.price}</span>
									<span class="text-slate-600 text-base ml-2">{tier.billing}</span>
								</div>
								<p class="text-sm text-slate-600 font-medium">{tier.bestFor}</p>
							</div>

							<div class="mb-6">
								<p class="text-slate-900 font-semibold text-base mb-2">{tier.tagline}</p>
								<p class="text-slate-600 text-sm leading-relaxed">{tier.description}</p>
							</div>

							<button
								type="button"
								data-checkout={planId}
								data-label={tier.cta}
								data-loading-label="Processing..."
								class={`block w-full text-center py-3.5 px-6 rounded-xl font-semibold transition-all duration-300 mb-2 ${colors.button} text-white shadow-md hover:shadow-lg transform hover:-translate-y-0.5 disabled:opacity-70 disabled:cursor-not-allowed disabled:transform-none`}
							>
								<span data-checkout-default>{tier.cta}</span>
								<span data-checkout-loading class="hidden items-center justify-center gap-2">
									<span class="inline-flex" set:html={iconSvg('loader', 'w-5 h-5 animate-spin')}></span>
									Processing...
								</span>
							</button>

							<p class="text-center text-sm text-slate-500 mb-8">
								Or{' '}
								<button
									type="button"
									data-checkout={planId}
									data-label="buy now"
									data-loading-label="Processing..."
									class={`${colors.link} hover:underline font-medium disabled:opacity-70`}
								>
									<span data-checkout-default>buy now</span>
									<span data-checkout-loading class="hidden items-center justify-center gap-2">
										<span class="inline-flex" set:html={iconSvg('loader', 'w-4 h-4 animate-spin')}></span>
										Processing...
									</span>
								</button>
							</p>

							<div class="mb-6">
								<h4 class="font-semibold text-slate-900 mb-4 text-sm">What's Included:</h4>
								<ul class="space-y-3">
									{tier.features.slice(0, 8).map((feature, idx) => (
										<li key={idx} class="flex items-start gap-3 text-sm">
											<div class={`${colors.iconBg} rounded-full p-0.5 mt-0.5 flex-shrink-0`}>
												<span class="inline-flex" set:html={iconSvg('check', `w-3.5 h-3.5 ${colors.iconText}`)}></span>
											</div>
											<span class="text-slate-700 leading-snug">{feature}</span>
										</li>
									))}
									{tier.features.length > 8 && (
										<li class="text-sm text-slate-500 pl-6 font-medium">+ {tier.features.length - 8} more features</li>
									)}
								</ul>
							</div>

							{tier.roi && (
								<div class={`p-4 rounded-xl border ${colors.roiBg} mb-6`}>
									<div class="flex items-center gap-2 mb-3">
										<span class="inline-flex" set:html={iconSvg('bar-chart', `w-4 h-4 ${colors.iconText}`)}></span>
										<h4 class={`font-semibold text-sm ${colors.roiText}`}>ROI Highlights</h4>
									</div>
									<ul class="space-y-2">
										{tier.roi.map((item, idx) => (
											<li key={idx} class={`text-xs ${colors.roiText} flex items-start gap-2`}>
												<span class="flex-shrink-0 mt-0.5">-</span>
												<span>{item}</span>
											</li>
										))}
									</ul>
									<p class="text-xs text-slate-500 mt-3 italic">*Based on industry averages</p>
								</div>
							)}

							{tier.valueProposition && (
								<div class="p-4 bg-slate-50 border border-slate-200 rounded-xl mb-4">
									<p class="text-sm font-semibold text-slate-900">{tier.valueProposition}</p>
								</div>
							)}

							{tier.popularText && (
								<p class="text-center text-sm text-slate-600 mb-4 italic">"{tier.popularText}"</p>
							)}

							{tier.enterpriseNote && (
								<p class="text-center text-xs text-slate-500 mt-4 italic">{tier.enterpriseNote}</p>
							)}
						</div>
					</div>
				);
			})}
		</div>
	</div>
</div>
