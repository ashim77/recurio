---
const steps = [
	{
		icon: 'cart',
		title: 'Create Subscription Product',
		description: 'Add your subscription product in just one click.',
		colorFrom: '#093865',
		colorTo: '#0B4A7D',
		iconBg: 'bg-blue-50',
		iconColor: 'text-[#093865]',
		mockupType: 'product',
	},
	{
		icon: 'refresh',
		title: 'Automated Renewals',
		description: 'Recurio handles renewals automatically, on time.',
		colorFrom: '#13B8A6',
		colorTo: '#0D9488',
		iconBg: 'bg-teal-50',
		iconColor: 'text-[#13B8A6]',
		mockupType: 'renewal',
	},
	{
		icon: 'card',
		title: 'Payment Recovery (Dunning)',
		description: 'Smart retry logic recovers failed payments instantly.',
		colorFrom: '#90D144',
		colorTo: '#7BC135',
		iconBg: 'bg-green-50',
		iconColor: 'text-[#90D144]',
		mockupType: 'payment',
	},
	{
		icon: 'users',
		title: 'Customer Self-Service Portal',
		description: 'Let customers manage their subscriptions with ease.',
		colorFrom: '#093865',
		colorTo: '#13B8A6',
		iconBg: 'bg-gradient-to-br from-blue-50 to-teal-50',
		iconColor: 'text-[#093865]',
		mockupType: 'portal',
	},
	{
		icon: 'trending',
		title: 'Analytics Dashboard',
		description: 'Track MRR, churn, and revenue trends in real time.',
		colorFrom: '#90D144',
		colorTo: '#13B8A6',
		iconBg: 'bg-gradient-to-br from-green-50 to-teal-50',
		iconColor: 'text-[#90D144]',
		mockupType: 'analytics',
	},
];

const iconSvg = (type, className) => {
	if (type === 'cart') {
		return `<svg viewBox="0 0 24 24" class="${className}" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"></circle><circle cx="19" cy="21" r="1"></circle><path d="M2 2h4l2.4 12.4a2 2 0 0 0 2 1.6h8.6a2 2 0 0 0 2-1.6L22 6H6"></path></svg>`;
	}
	if (type === 'refresh') {
		return `<svg viewBox="0 0 24 24" class="${className}" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path></svg>`;
	}
	if (type === 'card') {
		return `<svg viewBox="0 0 24 24" class="${className}" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="6" width="18" height="12" rx="2"></rect><line x1="3" y1="10" x2="21" y2="10"></line></svg>`;
	}
	if (type === 'users') {
		return `<svg viewBox="0 0 24 24" class="${className}" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 11a4 4 0 1 0-8 0"></path><path d="M4 20v-1a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v1"></path><circle cx="12" cy="7" r="3"></circle></svg>`;
	}
	return `<svg viewBox="0 0 24 24" class="${className}" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 17 6-6 4 4 7-7"></path><path d="M21 7v6h-6"></path></svg>`;
};
---

<section data-demo-section class="relative py-24 lg:py-32 overflow-hidden bg-gradient-to-b from-white to-[#E6F4F1]">
	<div class="absolute top-1/3 left-1/4 w-96 h-96 bg-[#13B8A6]/5 rounded-full blur-3xl"></div>
	<div class="absolute bottom-1/3 right-1/4 w-96 h-96 bg-[#90D144]/5 rounded-full blur-3xl"></div>

	<div class="relative max-w-7xl mx-auto px-6 lg:px-8">
		<div class="text-center mb-16 lg:mb-20" data-animate="fade-up">
			<h2 class="text-4xl lg:text-5xl xl:text-6xl font-bold text-[#093865] mb-6 leading-tight">
				See Recurio in Action
			</h2>
			<p class="text-xl lg:text-2xl text-[#093865]/80 max-w-4xl mx-auto leading-relaxed">
				Watch how subscription management, billing automation, and analytics work together seamlessly to grow your recurring revenue.
			</p>
		</div>

		<div class="relative">
			<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8 lg:gap-6">
				{steps.map((step, idx) => (
					<div class="relative">
						<div
							class="demo-card relative group bg-white rounded-2xl p-6 shadow-lg hover:shadow-2xl transition-all duration-500 hover:-translate-y-2 border border-gray-100 h-full"
							style={`transition-delay: ${idx * 150}ms;`}
							data-delay={idx * 150}
						>
							<div
								class="absolute inset-0 bg-gradient-to-br opacity-0 group-hover:opacity-5 rounded-2xl transition-opacity duration-500"
								style={`background-image: linear-gradient(to bottom right, ${step.colorFrom}, ${step.colorTo});`}
							></div>

							<div class="relative flex flex-col h-full">
								<div class="flex items-center gap-4 mb-6">
									<div class="flex-shrink-0 w-12 h-12 rounded-full bg-gradient-to-br from-[#90D144] to-[#13B8A6] flex items-center justify-center text-white font-bold shadow-lg">
										{idx + 1}
									</div>
									<div class={`flex-shrink-0 w-12 h-12 rounded-xl ${step.iconBg} flex items-center justify-center group-hover:scale-110 transition-all duration-500 shadow-sm group-hover:shadow-lg`}>
										<span class="inline-flex" set:html={iconSvg(step.icon, `w-6 h-6 ${step.iconColor} group-hover:text-[#90D144] transition-colors duration-500`)}></span>
									</div>
								</div>

								<div class="aspect-[4/3] rounded-lg bg-gradient-to-br from-gray-50 to-gray-100 mb-4 flex items-center justify-center overflow-hidden relative group/mockup">
									<div
										class="absolute inset-0 bg-gradient-to-br opacity-10"
										style={`background-image: linear-gradient(to bottom right, ${step.colorFrom}, ${step.colorTo});`}
									></div>

									{step.mockupType === 'product' && (
										<div class="relative w-full h-full p-4">
											<div class="bg-white rounded-lg p-3 shadow-sm">
												<div class="flex items-center gap-2 mb-2">
													<div class="w-3 h-3 rounded-full bg-red-400"></div>
													<div class="w-3 h-3 rounded-full bg-yellow-400"></div>
													<div class="w-3 h-3 rounded-full bg-green-400"></div>
												</div>
												<div class="space-y-2">
													<div class="h-2 bg-gray-200 rounded w-3/4"></div>
													<div class="inline-block px-2 py-0.5 bg-[#90D144]/20 text-[#90D144] rounded text-xs font-semibold">
														Subscription
													</div>
													<div class="h-2 bg-gray-200 rounded w-1/2"></div>
												</div>
											</div>
										</div>
									)}

									{step.mockupType === 'renewal' && (
										<div class="relative w-full h-full p-4 flex items-center justify-center">
											<div class="w-full max-w-[120px]">
												<div class="relative h-2 bg-gray-200 rounded-full overflow-hidden">
													<div class="absolute inset-0 bg-gradient-to-r from-[#13B8A6] to-[#90D144] rounded-full animate-progress"></div>
												</div>
												<div class="mt-3 flex items-center justify-center">
													<div class="w-8 h-8 rounded-full bg-[#90D144] flex items-center justify-center">
														<svg class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
															<path d="M5 13l4 4L19 7" />
														</svg>
													</div>
												</div>
											</div>
										</div>
									)}

									{step.mockupType === 'payment' && (
										<div class="relative w-full h-full p-4">
											<div class="bg-white rounded-lg p-3 shadow-sm space-y-2">
												<div class="flex items-center gap-2 text-xs">
													<div class="w-6 h-6 rounded-full bg-yellow-100 flex items-center justify-center">
														<span class="text-yellow-600">1</span>
													</div>
													<div class="h-1 bg-gray-200 rounded flex-1"></div>
												</div>
												<div class="flex items-center gap-2 text-xs">
													<div class="w-6 h-6 rounded-full bg-yellow-100 flex items-center justify-center">
														<span class="text-yellow-600">2</span>
													</div>
													<div class="h-1 bg-gray-200 rounded flex-1"></div>
												</div>
												<div class="flex items-center gap-2 text-xs">
													<div class="w-6 h-6 rounded-full bg-[#90D144] flex items-center justify-center">
														<svg class="w-4 h-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
															<path d="M5 13l4 4L19 7" />
														</svg>
													</div>
													<div class="h-1 bg-[#90D144] rounded flex-1"></div>
													<span class="text-[#90D144] font-semibold text-xs">Success</span>
												</div>
											</div>
										</div>
									)}

									{step.mockupType === 'portal' && (
										<div class="relative w-full h-full p-4">
											<div class="bg-white rounded-lg p-3 shadow-sm space-y-2">
												<div class="flex items-center gap-2">
													<div class="w-6 h-6 rounded-full bg-gradient-to-br from-[#093865] to-[#13B8A6]"></div>
													<div class="h-2 bg-gray-200 rounded w-12"></div>
												</div>
												<div class="grid grid-cols-3 gap-1 mt-2">
													<div class="h-6 bg-blue-50 rounded flex items-center justify-center text-xs text-[#093865] font-semibold">
														Pause
													</div>
													<div class="h-6 bg-red-50 rounded flex items-center justify-center text-xs text-red-600 font-semibold">
														Cancel
													</div>
													<div class="h-6 bg-green-50 rounded flex items-center justify-center text-xs text-[#90D144] font-semibold">
														Update
													</div>
												</div>
											</div>
										</div>
									)}

									{step.mockupType === 'analytics' && (
										<div class="relative w-full h-full p-4">
											<div class="bg-white rounded-lg p-3 shadow-sm">
												<div class="flex items-end justify-between h-16 gap-1">
													<div class="w-full bg-gradient-to-t from-[#13B8A6] to-[#13B8A6]/50 rounded-t" style="height: 40%;"></div>
													<div class="w-full bg-gradient-to-t from-[#13B8A6] to-[#13B8A6]/50 rounded-t" style="height: 60%;"></div>
													<div class="w-full bg-gradient-to-t from-[#90D144] to-[#90D144]/50 rounded-t" style="height: 85%;"></div>
													<div class="w-full bg-gradient-to-t from-[#90D144] to-[#90D144]/50 rounded-t" style="height: 100%;"></div>
												</div>
												<div class="mt-2 flex items-center justify-center">
													<span class="text-xs font-bold text-[#90D144]">+24% MRR</span>
												</div>
											</div>
										</div>
									)}

									<div class="absolute inset-0 bg-black/40 opacity-0 group-hover/mockup:opacity-100 transition-opacity duration-300 flex items-center justify-center">
										<div class="w-12 h-12 rounded-full bg-white/90 flex items-center justify-center transform scale-90 group-hover/mockup:scale-100 transition-transform duration-300">
											<svg viewBox="0 0 24 24" class="w-6 h-6 text-[#093865] ml-1" fill="currentColor" aria-hidden="true">
												<polygon points="5 3 19 12 5 21 5 3"></polygon>
											</svg>
										</div>
									</div>
								</div>

								<div class="mt-auto">
									<h4 class="text-base font-bold text-[#093865] mb-2 leading-tight">
										{step.title}
									</h4>
									<p class="text-sm text-gray-600 leading-relaxed">{step.description}</p>
								</div>
							</div>

							<div
								class="absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-b-2xl"
								style={`background-image: linear-gradient(to right, ${step.colorFrom}, ${step.colorTo});`}
							></div>

							{idx < steps.length - 1 && (
								<div class="hidden lg:block absolute -right-5 top-1/2 -translate-y-1/2 z-10">
									<div class="flex items-center gap-1">
										<div class="w-1.5 h-1.5 rounded-full bg-[#13B8A6]/40"></div>
										<svg viewBox="0 0 24 24" class="w-7 h-7 text-[#13B8A6] stroke-[3]" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
											<path d="M9 5l7 7-7 7"></path>
										</svg>
										<div class="w-1.5 h-1.5 rounded-full bg-[#13B8A6]/40"></div>
									</div>
								</div>
							)}
						</div>
					</div>
				))}
			</div>
		</div>
	</div>

	<style>
		[data-animate] {
			opacity: 0;
			transform: translateY(32px);
			transition: opacity 700ms ease, transform 700ms ease;
		}

		[data-demo-section].is-visible [data-animate] {
			opacity: 1;
			transform: translateY(0);
		}

		.demo-card {
			opacity: 0;
			transform: translateY(48px);
			transition: opacity 700ms ease, transform 700ms ease;
		}

		[data-demo-section].is-visible .demo-card {
			opacity: 1;
			transform: translateY(0);
		}

		@keyframes progress {
			0% {
				width: 0%;
			}
			100% {
				width: 100%;
			}
		}

		.animate-progress {
			animation: progress 2s ease-in-out infinite;
		}
	</style>

	<script type="module">
		const section = document.querySelector("[data-demo-section]");
		if (section) {
			const observer = new IntersectionObserver(
				([entry]) => {
					if (entry.isIntersecting) {
						section.classList.add("is-visible");
						observer.disconnect();
					}
				},
				{ threshold: 0.1 },
			);
			observer.observe(section);
		}
	</script>
</section>
